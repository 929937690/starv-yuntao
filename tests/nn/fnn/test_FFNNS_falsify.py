import numpy as np

from engine.nn.funcs.poslin import PosLin
from engine.nn.layer.layer import Layer
from engine.set.star import Star
from engine.nn.fnn.FFNNS import FFNNS
from engine.set.halfspace import HalfSpace

# ----------------- test for FFNNS falsify----------------------

W = np.matrix('1 1;'
              '0 1')
b = np.matrix('0;'
              '0.5')
L = Layer(W, b, 'poslin')
#print(L.__repr__())

Layer = []
Layer.append(L)
#print(Layer)
F = FFNNS(Layer)
#print(F.__repr__())

lb = np.matrix('-1; -1')
ub = np.matrix('1; 1')
I = Star(lb=lb, ub=ub)

[R, time] = F.reach(I)
G = np.matrix('-1 0')
g = np.matrix('-1.5')

U = HalfSpace(G, g)
#print(U.__repr__())
n_samples = 1000
U_list = []
U_list.append(U)
#counter_inputs = F.falsify(I, U_list, n_samples)
counter_inputs = np.matrix('0.972130771586642 0.907812651569086 0.729031735630226 0.891800310378648 0.576064037270699	0.994234922167348 0.983905629667039 0.848207275423777 0.746439207964112 0.660461880205715 0.700962406800671 0.989428809537489 0.858915701295181 0.990464271048894 0.776630815380258 0.923090674485057 0.563417289683019 0.867811899979229 0.576010697005635 0.707420468374267 0.694635824647438 0.848284771194169 0.916091431255633 0.952761299711942 0.907051936551502 0.808900881011581 0.725063889454765;'
                           '0.711775373298286 0.817293869833123 0.926324917223961 0.858921917551315 0.980470380500418 0.824816958723561 0.851304922408892 0.939226933254048 0.988358912100753 0.932811287601100 0.867295863828632 0.896116698058446 0.737928217813934 0.816239636192212 0.894975823995929 0.626916411238979 0.959925360100785 0.715966432186176 0.952792529619657 0.888114439177068 0.968863247892454 0.845397901965019 0.663622908101978 0.611074395919472 0.878117252969130 0.886477062398286 0.774948628170125')
counter_outputs = F.sample(counter_inputs)
print(counter_outputs)